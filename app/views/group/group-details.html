<div>
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">Modifica Gruppo</h1>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-primary">
                <div class="panel-heading">Costruisci Gruppo</div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-lg-12">
                            <form name="formGroupName" role="form">
                                <div class="form-group">
                                    <input ng-disabled="ctrl.value" class="form-control" placeholder="Nome del Gruppo"
                                           ng-model="ctrl.currentGroup.name" required>
                                </div>
                            </form>
                        </div>
                    </div>
                    <p></p>
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="form">
                                <div class="form-group">
                                    <ul class="nav nav-tabs">
                                        <li ng-class="{'active':ctrl.selectedTab === 'ruoli'}"
                                            ng-click="ctrl.selectTab('ruoli')" style="cursor:pointer">
                                            <a data-toggle="tab">Ruoli</a>
                                        </li>
                                        <li ng-class="{'active':ctrl.selectedTab === 'utenti'}"
                                            ng-click="ctrl.selectTab('utenti')" style="cursor:pointer">
                                            <a data-toggle="tab">Utenti</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="tab-content">
                            <div class="tab-pane active">
                                <!-- /.row (nested) -->
                                <div class="row" ng-show="ctrl.selectedTab === 'ruoli'">
                                    <div id="sid-iniziale" class="col-lg-6">
                                        <div class="panel-body">
                                            <div class="table-responsive">
                                                <table id="datatableSidIniziale"
                                                       class="table table-striped table-bordered">
                                                    <thead>
                                                    <tr>
                                                        <th class="col-md-1">ID</th>
                                                        <th class="col-md-8">Nome del Sid</th>
                                                        <th class="col-md-2">Principal</th>
                                                        <th class="col-md-1"></th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr ng-repeat="s in ctrl.sids track by s.id">
                                                        <td>{{s.id}}</td>
                                                        <td>{{s.authorityName}}</td>
                                                        <td>{{s.principal | PrincipalFilter}}</td>
                                                        <td>
                                                            <button ng-disabled="ctrl.value" class="btn btn-success"
                                                                    ng-click="ctrl.selectSids($index)"><i
                                                                    class="fa fa-arrow-right"></i></button>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!-- /.table-responsive -->
                                        </div>
                                    </div>
                                    <div id="sid-scelto" class="col-lg-6">
                                        <div class="panel-body">
                                            <div class="table-responsive">
                                                <table id="datatableSidScelto"
                                                       class="table table-striped table-bordered">
                                                    <thead>
                                                    <tr>
                                                        <th class="col-md-1">ID</th>
                                                        <th class="col-md-8">Nome del Sid</th>
                                                        <th class="col-md-2">Principal</th>
                                                        <th class="col-md-1"></th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr ng-repeat="gs in ctrl.currentGroup.sids"
                                                        ng-disabled="ctrl.value">
                                                        <td>{{gs.id}}</td>
                                                        <td>{{gs.authorityName}}</td>
                                                        <td>{{gs.principal | PrincipalFilter}}</td>
                                                        <td>
                                                            <button ng-disabled="ctrl.value" class="btn btn-danger"
                                                                    ng-click="ctrl.deselectSids($index)">
                                                                <i class="fa fa-arrow-left"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!-- /.table-responsive -->
                                        </div>
                                    </div>
                                </div>
                                <!-- Tab per utenti -->
                                <div class="row" ng-show="ctrl.selectedTab === 'utenti'">
                                    <div id="utenti-iniziale" class="col-lg-6">
                                        <div class="panel-body">
                                            <div class="table-responsive">
                                                <table id="datatableUtentiIniziali"
                                                       class="table table-striped table-bordered">
                                                    <thead>
                                                    <tr>
                                                        <th class="col-md-1">ID</th>
                                                        <th class="col-md-8">Nome Utente</th>
                                                        <th class="col-md-2">Tipo</th>
                                                        <th class="col-md-1"></th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr ng-repeat="u in ctrl.users track by u.id">
                                                        <td>{{u.id}}</td>
                                                        <td>{{u.username}}</td>
                                                        <td>{{u.roles[0].name}}</td>
                                                        <td>
                                                            <button ng-disabled="ctrl.value" class="btn btn-success"
                                                                    ng-click="ctrl.selectUser($index)">
                                                                <i class="fa fa-arrow-right"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!-- /.table-responsive -->
                                        </div>
                                    </div>
                                    <div id="utente-scelto" class="col-lg-6">
                                        <div class="panel-body">
                                            <div class="table-responsive">
                                                <table id="datatableUtentiScelti"
                                                       class="table table-striped table-bordered">
                                                    <thead>
                                                    <tr>
                                                        <th class="col-md-1">ID</th>
                                                        <th class="col-md-8">Nome Utente</th>
                                                        <th class="col-md-2">Tipo</th>
                                                        <th class="col-md-1"></th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr ng-repeat="gs in ctrl.currentGroup.members"
                                                        ng-disabled="ctrl.value">
                                                        <td>{{gs.id}}</td>
                                                        <td>{{gs.username}}</td>
                                                        <td>{{gs.roles[0].name}}</td>
                                                        <td>
                                                            <button ng-disabled="ctrl.value" class="btn btn-danger"
                                                                    ng-click="ctrl.deselectUser($index)">
                                                                <i class="fa fa-arrow-left"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <!-- /.table-responsive -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /.panel-body -->
            </div>

            <!-- /.panel -->
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <div class="row">
        <div class="col-lg-12">
            <button class="btn btn-primary" ng-disabled="!hasPermission('group_update')"
                    ng-click="ctrl.changeState()">
                {{ ctrl.value ? "Abilita Modifica" : "Disabilita Modifica"}}
            </button>
            <button type="button" class="btn btn-warning"
                    ng-disabled="!(!formGroupName.$invalid && hasPermission('group_update'))"
                    ng-click="ctrl.updateGroup()">Modifica
                Gruppo
            </button>
            <button type="button" class="btn btn-danger" ng-click="ctrl.resetFields()">Reset</button>
            <!--<div>{{ctrl.sidChoose}}</div>-->
            <!--<div>{{ctrl.sids}}</div>-->
            <div ng-if="isDebug">{{ctrl.currentGroup}}</div>
        </div>
    </div>
</div>