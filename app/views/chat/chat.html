<style>
    .messaggio_out {
        background: #25D366 none repeat scroll 0 0;
        border-radius: 3px;
        color: white;
        font-size: 14px;
        margin: 0;
        padding: 5px 10px 5px 12px;
        word-break: break-word;
        /*word-break: break-all;*/
        float: right;
    }

    .messaggio_in {
        background: #05728f none repeat scroll 0 0;
        border-radius: 3px;
        color: white;
        font-size: 14px;
        margin: 0;
        padding: 5px 10px 5px 12px;
        word-break: break-word;
        /*word-break: break-all;*/
        float:left;
    }

    .colonna {
        float: right;
    }

</style>

<div>
    <div class="row">
        <div class="col-lg-12" align="center">
            <h1 ng-show="ctrl.type == 'prodotto'" class="page-header">Chat prodotto {{ctrl.id}}</h1>
            <h1 ng-show="ctrl.type == 'leader-member'" class="page-header">Chat leader-member ticket {{ctrl.id}}</h1>
            <h1 ng-show="ctrl.type == 'team'" class="page-header">Chat team {{ctrl.id}}</h1>
        </div>
        <!-- /.col-lg-12 -->

    </div>



    <ul>
        <table ng-repeat="message in ctrl.messages" width="100%">
            <tr>

                <td>

                    <table ng-if="message.username == ctrl.userInfo.username" width="100%">
                        <tr>
                            <td class="colonna">{{message.completeName}}</td>
                        </tr>

                        <tr>
                            <td class="colonna">{{ message.timestamp | date:"MM/dd/yyyy 'ore' h:mma" }} </td>
                        </tr>

                        <tr>
                            <td class="messaggio_out">
                                {{ message.text }}
                            </td>
                        </tr>

                        <tr><td height="20px"></td></tr>
                    </table>

                    <table ng-if="message.username != ctrl.userInfo.username" width="100%">

                        <tr>
                            <td>{{message.completeName}}</td>
                        </tr>

                        <tr>
                            <td>{{ message.timestamp | date:"MM/dd/yyyy 'ore' h:mma" }} </td>
                        </tr>

                        <tr>
                            <td class="messaggio_in">
                                {{ message.text }}
                            </td>
                        </tr>

                        <tr><td height="20px"></td></tr>
                    </table>





                    <!-- codice che produceva doppioni
                    <table width="100%">

                       <span ng-show="message.username == ctrl.userInfo.username">
                            <tr>
                                <td class="colonna">{{message.completeName}}</td>
                            </tr>

                            <tr>
                                <td class="colonna">{{ message.timestamp | date:"MM/dd/yyyy 'ore' h:mma" }} </td>
                            </tr>

                            <tr>
                                <td class="messaggio_out">
                                {{ message.text }} - {{message.username}} , {{ctrl.userInfo.username}}
                                </td>
                            </tr>
                        </span>


                        <span ng-show="message.username != ctrl.userInfo.username">
                            <tr>
                                <td>{{message.completeName}}</td>
                            </tr>

                            <tr>
                                <td>{{ message.timestamp | date:"MM/dd/yyyy 'ore' h:mma" }} </td>
                            </tr>

                            <tr>
                                <td class="messaggio_in">
                                {{ message.text }} - {{message.username}} , {{ctrl.userInfo.username}}
                                </td>
                            </tr>
                        </span>




                        <tr><td height="20px"></td></tr>
                    </table>

                    -->
                </td>


            </tr>
        </table>
    </ul>


    <div class="col-lg-12" align="center" ng-controller="ChatCtrl">
        <form>
            <input ng-model="ctrl.messageContent" type="text" style="width:90%; height:50px" placeholder="Scrivi un messaggio..."/>

            <!--<textarea ng-model="ctrl.messageContent" style="width:90%; height:150px" placeholder="Scrivi un messaggio..." autofocus></textarea>-->

            <button type="submit" class="btn btn-primary" ng-click="ctrl.sendMessage()" style="vertical-align: center;">Invia</button>
        </form>
    </div>
</div>

